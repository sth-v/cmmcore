<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Wasm Demo</title>
    <script src="cmmcore.js"></script>
</head>
<body>
    <script>
        cmmcore().then(cmm => {
    const vec3 = cmm.vec3;
    const vec4 = cmm.vec4;
    const NURBSSurface = cmm.NURBSSurface;
    const controlPointsArray = [[[0.62332799, 0.21476556, 0.75989061, 1.        ],
       [0.13268676, 0.85092707, 0.19604599, 1.        ],
       [0.89074325, 0.64847999, 0.07050099, 1.        ],
       [0.91934447, 0.41607874, 0.52330899, 1.        ]],
      [[0.50844946, 0.88889217, 0.78646248, 1.        ],
       [0.25824996, 0.33773866, 0.46611303, 1.        ],
       [0.7197276 , 0.5685781 , 0.05564343, 1.        ],
       [0.13142747, 0.81370473, 0.33629716, 1.        ]],
      [[0.75692357, 0.64838686, 0.14546997, 1.        ],
       [0.35443106, 0.60798288, 0.11322816, 1.        ],
       [0.17406329, 0.12349951, 0.91478453, 1.        ],
       [0.06059289, 0.53419607, 0.10507294, 1.        ]],
      [[0.05756793, 0.59932455, 0.02830079, 1.        ],
       [0.17660584, 0.8646054 , 0.62055444, 1.        ],
       [0.42505789, 0.73934683, 0.41718578, 1.        ],
       [0.33858193, 0.57782595, 0.53923527, 1.        ]]];
    const Module = cmm.Module;
    // Create some control points (2x2 grid of vec4)
    const controlPoints = cmm.create2DVector(4,4,new vec4(0.0, 0.0, 0.0, 1.0))

        // Create control points as vector<vector<vec4>>

    // Row 1 of control points

    cmm.convertJSArrayToNURBSSurfaceControlPoints(controlPointsArray,controlPoints )


    // Define the degree of the surface
    const degree = [3, 3];

    // Optionally, define the knot vectors (empty in this case)
    const knotsU = new cmm.vector_double();
    const knotsV = new cmm.vector_double();

    // Create a NURBSSurface instance
    const surface = new NURBSSurface(controlPoints, degree, knotsU, knotsV);

    // Evaluate the surface at u=0.5, v=0.5
    const result = new vec3();
    surface.evaluate(0.5, 0.5, result);

    console.log("Evaluated surface point:", result.x, result.y, result.z);
});

    </script>


</body>
</html>