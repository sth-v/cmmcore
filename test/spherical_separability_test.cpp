//
// Created by Andrew Astakhov on 13.10.24.
//
#include <iostream>
#include <vector>
#include <limits>
#include <cmath>
#include <algorithm>
#include <random>
#include <ctime>

#include <cmmcore/bvh.hpp>
#include <cmmcore/separability.h>
#define print_assert(assertion, text) if (!(assertion)) { std::cout << "Assertion failed: " << #assertion << "\n"<< (text) << std::endl ; };assert(assertion)

int main()
{
    // Custom points on the unit sphere

    std::vector<cmmcore::vec3> v1 = {
            {-0.29189793630234256, -0.50342166585652681, 0.81324179745551251},
            {-0.32323004254223214, -0.54727945919096721, 0.77201524152427803},
            {-0.357016374238458, -0.59404272906340283, 0.72086929784290987},
            {-0.39268014880643576, -0.64268847223035031, 0.65784027574752058},
            {-0.4291390300426462, -0.69144828144363024, 0.58115313556988357},
            {-0.46470737220298308, -0.73770217099314261, 0.48973724090802229},
            {-0.49714887066276903, -0.7781117285127257, 0.38390772113838983},
            {-0.52398519413403877, -0.80913272602883901, 0.26597696892297495},
            {-0.54306016234953813, -0.82787442521370858, 0.14039086916877808},
            {-0.55315630249642245, -0.83297491357093068, 0.013072810332414574},
            {-0.55433442646969888, -0.82500804242206338, -0.10988663963114449},
            {-0.25284143411709831, -0.55124039974618066, 0.79511334467563788},
            {-0.28334732183276085, -0.60086273440037175, 0.74744783739008203},
            {-0.31621199522012211, -0.65335247470232571, 0.6878521046556858},
            {-0.35066023944501945, -0.70704497644286168, 0.61410487521210477},
            {-0.38530732505912113, -0.75923306760335596, 0.52450301649598041},
            {-0.4181109680111893, -0.80617288916668861, 0.41865079863936772},
            {-0.44657220052617053, -0.84354929075264629, 0.29832509748246305},
            {-0.46826323857137275, -0.86748470346004625, 0.16792804609559847},
            {-0.48153779792206014, -0.87576613378876245, 0.033985704068869235},
            {-0.48604793141604097, -0.86860466716858786, -0.096350093612483326},
            {-0.48274595393475517, -0.84843013218157481, -0.21707753169312327},
            {-0.20608665184661801, -0.60399828821330492, 0.76987944495618799},
            {-0.23488588402438376, -0.6596632275626565, 0.71391389374889092},
            {-0.26582866205468725, -0.71768732198611629, 0.64363035221360665},
            {-0.29792769008894493, -0.77542278773650286, 0.55673924932342966},
            {-0.32951960108202921, -0.8288817471504617, 0.45207508418794567},
            {-0.35832806996185912, -0.87307021452643629, 0.33068020016954719},
            {-0.38187018780957827, -0.90305715362122552, 0.19662893214328334},
            {-0.39816555796223785, -0.91555175275516032, 0.056825843412778715},
            {-0.40639970708075018, -0.91013688868911691, -0.080561293013300048},
            {-0.40711110764124891, -0.88930364573355614, -0.20832563865285772},
            {-0.40181226122586061, -0.85730820489045079, -0.32182223129559184},
            {-0.15023454710995482, -0.66111757317741771, 0.73508716169626354},
            {-0.17626457285974309, -0.72250837320068217, 0.66851510903604572},
            {-0.20414324185041563, -0.78491365148132086, 0.58500948413257559},
            {-0.23272627263809301, -0.84431281763361421, 0.48267416338930713},
            {-0.26021163518396617, -0.89524483792849285, 0.36169957848644652},
            {-0.2843607350517956, -0.93180911447357673, 0.22554544230547344},
            {-0.30307929984169413, -0.94950296499417552, 0.081160689220445975},
            {-0.31512598536706876, -0.94699174679027398, -0.06246795064302809},
            {-0.32049194810939485, -0.92655801976997509, -0.19691406043497142},
            {-0.32020909243910317, -0.89292152762400423, -0.31647635397441704},
            {-0.31580313245932723, -0.85139517078435301, -0.41880143826634475},
            {-0.084099151932951838, -0.72101544037623977, 0.68779653051117917},
            {-0.1062896710635662, -0.78675925479959663, 0.60803978555056926},
            {-0.13010911371431177, -0.85090579804840416, 0.50895082412359305},
            {-0.15442076703360516, -0.90782810453639773, 0.38987479954801435},
            {-0.17754313184091428, -0.95091805575846389, 0.25344286845098368},
            {-0.19759114349298371, -0.97450859693901426, 0.10625786796792523},
            {-0.21307261313734632, -0.97612296092183459, -0.042237740138569055},
            {-0.22338779927842664, -0.95748360386667841, -0.18254599272517297},
            {-0.22888984605267898, -0.92349594742465191, -0.30783871339424673},
            {-0.23053782345078128, -0.88011686363780528, -0.4150260453259883},
            {-0.22945488409834078, -0.83258347847547942, -0.50413808379558867},
            {-0.0072189561524910514, -0.78063691295945459, 0.62494311484902476},
            {-0.024874379959604832, -0.84782756628041267, 0.52968828859684769},
            {-0.044312755760938106, -0.90929435013124116, 0.41378758378698943},
            {-0.064640437999503961, -0.95812307421896437, 0.27896556852850668},
            {-0.084522252416223284, -0.98775622291788046, 0.13112449402567977},
            {-0.1025125521344607, -0.99452411940741936, -0.020321234504247644},
            {-0.11752461683468866, -0.97924223177535985, -0.16514422770860585},
            {-0.12912802227824732, -0.94659037038660165, -0.2954532527386774},
            {-0.13750678516944154, -0.90288949451047884, -0.4072866861744649},
            {-0.14320048375355196, -0.85397290257414116, -0.50022385301167405},
            {-0.14684278646045087, -0.80413607858781444, -0.57602288424848447},
            {0.079403387763317138, -0.8351957333928719, 0.54419039768637179},
            {0.066047298745856076, -0.89925904698956927, 0.43240134219933563},
            {0.050056291911733435, -0.95234206872621108, 0.30089691220470777},
            {0.031972628249510533, -0.98745173354785887, 0.1546506545610046},
            {0.012863388461621897, -0.99991401184763717, 0.0025499309889873956},
            {-0.0059510317734331689, -0.98942104095513606, -0.144950298157978},
            {-0.023316736097445914, -0.95996853754749845, -0.27913569591988513},
            {-0.038536760343458647, -0.91781918686994513, -0.39512385186878268},
            {-0.051398874345914017, -0.86916045576602396, -0.49185186575692719},
            {-0.062029399655240625, -0.81875097923898477, -0.57078821604305563},
            {-0.070719643343106348, -0.76965125600432616, -0.63453579581957953},
            {0.17259950219195247, -0.87860361710387636, 0.44526968890221486},
            {0.161940974711036, -0.93401504003202085, 0.31841957493788253},
            {0.14707106720277907, -0.97337294397022744, 0.17582722524844752},
            {0.12843168088344473, -0.99139151253225022, 0.025459226706051892},
            {0.10725189331160898, -0.98664919549414309, -0.12255772685488144},
            {0.085173156124810898, -0.96209109856790143, -0.25908734344260648},
            {0.06371114946667096, -0.92344083697532908, -0.37841499711287735},
            {0.043901486532672375, -0.87688259958386039, -0.47869569250962857},
            {0.026245465189255589, -0.82746728496308175, -0.56090022987410704},
            {0.010841513053192168, -0.77860990461243385, -0.62741459819973422},
            {-0.0024459747223553601, -0.73228049650620985, -0.68099874569948848},
            {0.26697248885439323, -0.90498201288445868, 0.33126008897916542},
            {0.25623113927918861, -0.94695756995769009, 0.19395093184492662},
            {0.23950235465901393, -0.96973427347136798, 0.047476951963517013},
            {0.21764645436326835, -0.97101006457634986, -0.098840656586904066},
            {0.19245490869540754, -0.95252351170343152, -0.23592386011424368},
            {0.16602790292081293, -0.9190515006838752, -0.35746199034643411},
            {0.14015215854763119, -0.87637053472539495, -0.46079502853173787},
            {0.11600073715615437, -0.82956784208579648, -0.54622433519236746},
            {0.094151168806848803, -0.78230874513523363, -0.61573418347306352},
            {0.074752983434215825, -0.73685149280869344, -0.67190912258525259},
            {0.057705552719746082, -0.69438195448906614, -0.71728918189615365},
            {0.35601763643659595, -0.91087027982828939, 0.20872655765770157},
            {0.34221907801506091, -0.93716808465540213, 0.067838659670181947},
            {0.32126842552760837, -0.94403014083900316, -0.074790988404376799},
            {0.29478752496270283, -0.93206933390759816, -0.21058744481903524},
            {0.26512764627127733, -0.90489303400604171, -0.33298037207918607},
            {0.23461539940310744, -0.86752034791340604, -0.43859327436603879},
            {0.2050318113695451, -0.82478110831202123, -0.52697066303364259},
            {0.17746706144286914, -0.78042243116608734, -0.59953838162009843},
            {0.15242774963597344, -0.73692853230437871, -0.65856064217096033},
            {0.13002555649224007, -0.69572901816332788, -0.70643788682684261},
            {0.1101460941589978, -0.65751132867555662, -0.7453500456864689},
            {0.43411965622790405, -0.89673543665695166, 0.086056264851736494},
            {0.41527303587903508, -0.90824749817226558, -0.051330183475515483},
            {0.38919203857707729, -0.90255825061814887, -0.18416883924628907},
            {0.35815494218504856, -0.88209962362236438, -0.30598250177699327},
            {0.32473963515079729, -0.85092291395795461, -0.41288541250985195},
            {0.29116990369821055, -0.81333861676083852, -0.50368678925095989},
            {0.25900418528940411, -0.77297463021481116, -0.57916064528492261},
            {0.22913582640654864, -0.73242986942313026, -0.64112655492796766},
            {0.20194752666347274, -0.69333636841545443, -0.69173830073733433},
            {0.17749083117023529, -0.65658698973824392, -0.73306925304296455},
            {0.15563075394534651, -0.62257547188882911, -0.76692819105102983}};
    std::vector<cmmcore::vec3> w1 = {

            {-0.98480775301220824, 0.17364817766693011, 0.0}, {-0.99562283415630637, -0.093462142638419385, -0.0},
            {-0.94671338531629079, -0.32207726722475849, -0.0}, {-0.87038300953666503, -0.49237528036031386, -0.0},
            {-0.79122206015252894, -0.61152894578097272, -0.0}, {-0.71997466450879832, -0.69400034759749474, -0.0},
            {-0.65923708594616515, -0.75193514648087068, -0.0}, {-0.60838076785158279, -0.7936452868305327, -0.0},
            {-0.56588498608398707, -0.82448419179795429, -0.0}, {-0.5301999846979969, -0.84787261792455826, -0.0},
            {-0.50000000000000011, -0.8660254037844386, -0.0},
            {-0.98480775301220813, 0.17364817766693014, 1.290207832704612e-16},
            {-0.98683672408002698, -0.043633636297656299, -0.15572214290345687},
            {-0.93074236307668456, -0.23150109915657005, -0.28306517741278059},
            {-0.84928962580619294, -0.37274875669546698, -0.3738522380298937},
            {-0.76669299104840394, -0.4724176821186023, -0.43474520250249948},
            {-0.6931623804936754, -0.54194032872010134, -0.47521215722568555},
            {-0.63088242852182375, -0.59112789332871396, -0.50254867934476022},
            {-0.57895673002883119, -0.62677327606661715, -0.5215020279567889},
            {-0.53569847559040518, -0.65328798363800344, -0.53501584433015448},
            {-0.49945511209278176, -0.67350978087213909, -0.54491207187394008},
            {-0.46883617403980882, -0.68928656418667467, -0.55233746418602037},
            {-0.98480775301220813, 0.17364817766693, 1.6916695195472951e-16},
            {-0.96383438927142973, 0.086819086911101129, -0.25196372001876149},
            {-0.88892968401831529, 0.0056303874166702917, -0.45800907808539804},
            {-0.7940664302620728, -0.059562451784904505, -0.60490562790258406},
            {-0.70247505442141001, -0.10821966563256799, -0.70343251409499996},
            {-0.62296690962606815, -0.14384203096913517, -0.76890942225831815},
            {-0.55664897164553817, -0.17012903893885922, -0.81314084418119414},
            {-0.50192359892260474, -0.18989668011564745, -0.84380800643608245},
            {-0.45666916511645228, -0.20509049193014975, -0.86567382064591269},
            {-0.41896399063254325, -0.21702194709404626, -0.88168625317216065},
            {-0.3872482184565415, -0.22657827498751318, -0.89370079031290883},
            {-0.98480775301220813, 0.17364817766692991, 1.5473233149988488e-16},
            {-0.93540193980679398, 0.24806752064708984, -0.25196372001876138},
            {-0.83724637038078908, 0.29874102442677397, -0.45800907808539815},
            {-0.72580680663477681, 0.32755711070652688, -0.60490562790258406},
            {-0.62309731937567181, 0.34195384001475942, -0.70343251409499996},
            {-0.53620053592109973, 0.34823452677801076, -0.76890942225831815},
            {-0.46489137274164988, 0.35025416353653704, -0.81314084418119426},
            {-0.4067054123556556, 0.35011249025846031, -0.84380800643608223},
            {-0.35898356515571012, 0.34891207516565559, -0.86567382064591281},
            {-0.31947149292249633, 0.34722804635730131, -0.88168625317216065},
            {-0.28639995921038991, 0.34536062421528235, -0.89370079031290883},
            {-0.98480775301220813, 0.17364817766692983, 9.2473803429671758e-17},
            {-0.91239960499819661, 0.3785202438558472, -0.1557221429034569},
            {-0.7954336913224197, 0.53587251100001432, -0.2830651774127807},
            {-0.67058361109065701, 0.64074341561708947, -0.37385223802989392},
            {-0.55887938274867788, 0.70615185650079371, -0.43474520250249959},
            {-0.46600506505349243, 0.74633282452897687, -0.47521215722568572},
            {-0.3906579158653643, 0.77125301792639189, -0.50254867934476033},
            {-0.32967228124942927, 0.78698908620942998, -0.52150202795678902},
            {-0.27995425468175733, 0.7971095668735092, -0.53501584433015459},
            {-0.23898037146225767, 0.80371588013539419, -0.54491207187394031},
            {-0.20481200362712251, 0.80806891341444387, -0.55233746418602048},
            {-0.98480775301220824, 0.17364817766692978, 2.1427276900725053e-32},
            {-0.90361349492191734, 0.42834875019661028, -3.2444608489121011e-17},
            {-0.77946266908281381, 0.62644867906820267, -5.8976447965752819e-17},
            {-0.64949022736018491, 0.7603699392819363, -7.7891873753506674e-17},
            {-0.53435031364455299, 0.84526312016316441, -9.0578883803711864e-17},
            {-0.43919278103836951, 0.89839284340637027, -9.9010147837592646e-17},
            {-0.36230325844102274, 0.93206027107854861, -1.0470569466908878e-16},
            {-0.30024824342667766, 0.95386109697334587, -1.0865461268299218e-16},
            {-0.24976774418817532, 0.96830577503346038, -1.1147020764754095e-16},
            {-0.20823549885704265, 0.97807871718781336, -1.1353208030219892e-16},
            {-0.17364817766693122, 0.98480775301220791, -1.15079156022785e-16},
            {-0.98480775301220813, 0.17364817766692983, -9.2748812542120928e-17},
            {-0.91239960499819672, 0.37852024385584732, 0.15572214290345687},
            {-0.79543369132241959, 0.53587251100001432, 0.28306517741278053},
            {-0.67058361109065701, 0.64074341561708947, 0.37385223802989365},
            {-0.55887938274867788, 0.70615185650079393, 0.43474520250249943},
            {-0.46600506505349226, 0.74633282452897709, 0.47521215722568538},
            {-0.39065791586536414, 0.771253017926392, 0.50254867934476022},
            {-0.32967228124942921, 0.7869890862094302, 0.5215020279567889},
            {-0.27995425468175728, 0.79710956687350931, 0.53501584433015437},
            {-0.23898037146225765, 0.80371588013539419, 0.54491207187394008},
            {-0.20481200362712246, 0.80806891341444398, 0.55233746418602037},
            {-0.98480775301220824, 0.17364817766692991, -1.5893708774110445e-16},
            {-0.93540193980679398, 0.2480675206470899, 0.25196372001876149},
            {-0.83724637038078897, 0.29874102442677414, 0.45800907808539815},
            {-0.72580680663477704, 0.32755711070652704, 0.60490562790258418},
            {-0.6230973193756717, 0.34195384001475965, 0.70343251409499996},
            {-0.53620053592109973, 0.34823452677801087, 0.76890942225831804},
            {-0.46489137274164982, 0.35025416353653727, 0.81314084418119403},
            {-0.40670541235565555, 0.35011249025846058, 0.84380800643608234},
            {-0.35898356515571012, 0.34891207516565587, 0.86567382064591269},
            {-0.31947149292249621, 0.34722804635730148, 0.88168625317216054},
            {-0.28639995921038974, 0.34536062421528257, 0.89370079031290872},
            {-0.98480775301220813, 0.17364817766693003, -1.5424969517927379e-16},
            {-0.96383438927142961, 0.086819086911101226, 0.25196372001876138},
            {-0.88892968401831529, 0.0056303874166704175, 0.45800907808539809},
            {-0.79406643026207269, -0.059562451784904429, 0.60490562790258418},
            {-0.70247505442140989, -0.10821966563256777, 0.70343251409499996},
            {-0.62296690962606815, -0.143842030969135, 0.76890942225831815},
            {-0.55664897164553806, -0.17012903893885903, 0.81314084418119426},
            {-0.50192359892260474, -0.18989668011564712, 0.84380800643608223},
            {-0.45666916511645211, -0.20509049193014953, 0.86567382064591281},
            {-0.41896399063254308, -0.21702194709404596, 0.88168625317216054},
            {-0.38724821845654162, -0.22657827498751296, 0.89370079031290883},
            {-0.98480775301220813, 0.17364817766693008, -1.2105998566910587e-16},
            {-0.98683672408002698, -0.04363363629765625, 0.15572214290345693},
            {-0.93074236307668445, -0.23150109915656991, 0.2830651774127807},
            {-0.84928962580619294, -0.37274875669546698, 0.37385223802989387},
            {-0.76669299104840394, -0.47241768211860213, 0.43474520250249965},
            {-0.6931623804936754, -0.54194032872010123, 0.47521215722568572},
            {-0.63088242852182363, -0.59112789332871396, 0.50254867934476044},
            {-0.57895673002883108, -0.62677327606661704, 0.52150202795678924},
            {-0.53569847559040507, -0.65328798363800311, 0.5350158443301547},
            {-0.49945511209278176, -0.67350978087213897, 0.5449120718739402},
            {-0.46883617403980871, -0.68928656418667467, 0.5523374641860207},
            {-0.98480775301220824, 0.17364817766693011, -4.3239848805361649e-32},
            {-0.99562283415630637, -0.093462142638419385, 6.4889216978242034e-17},
            {-0.94671338531629079, -0.32207726722475849, 1.1795289593150569e-16},
            {-0.87038300953666503, -0.49237528036031386, 1.5578374750701335e-16},
            {-0.79122206015252894, -0.61152894578097272, 1.8115776760742373e-16},
            {-0.71997466450879832, -0.69400034759749474, 1.9802029567518532e-16},
            {-0.65923708594616515, -0.75193514648087068, 2.0941138933817758e-16},
            {-0.60838076785158279, -0.7936452868305327, 2.1730922536598434e-16},
            {-0.56588498608398707, -0.82448419179795429, 2.2294041529508191e-16},
            {-0.5301999846979969, -0.84787261792455826, 2.2706416060439784e-16},
            {-0.50000000000000011, -0.8660254037844386, 2.3015831204557e-16}
        };



    auto res2 = cmmcore::SphericalSeparabilityTest(v1, w1);

    print_assert(res2==false, "["+cmmcore::format_vec3vec(v1)+","+ cmmcore::format_vec3vec(w1)+"]");


    v1 = {
        {-0.63560718924333848, -0.63855635793689802, 0.43387703179650694},
        {-0.63560718924333848, -0.63855635793689802, 0.43387703179650705},
        {-0.63560718924333859, -0.63855635793689791, 0.43387703179650683},
        {-0.6356071892433387, -0.63855635793689791, 0.43387703179650672},
        {-0.63560718924333859, -0.63855635793689802, 0.43387703179650688},
        {-0.63560718924333859, -0.63855635793689802, 0.43387703179650688},
        {-0.63560718924333859, -0.63855635793689791, 0.43387703179650694},
        {-0.63560718924333848, -0.63855635793689802, 0.43387703179650694},
        {-0.63560718924333848, -0.63855635793689802, 0.43387703179650694},
        {-0.63560718924333848, -0.63855635793689802, 0.43387703179650711},
        {-0.6356071892433387, -0.63855635793689802, 0.43387703179650677},
        {-0.63560718924333859, -0.63855635793689802, 0.43387703179650688},
        {-0.63560718924333848, -0.63855635793689802, 0.43387703179650705},
        {-0.6356071892433387, -0.63855635793689802, 0.43387703179650672},
        {-0.6356071892433387, -0.63855635793689791, 0.43387703179650672},
        {-0.63560718924333859, -0.63855635793689802, 0.43387703179650688},
        {-0.63560718924333859, -0.63855635793689802, 0.43387703179650688},
        {-0.63560718924333859, -0.63855635793689791, 0.43387703179650694},
        {-0.63560718924333848, -0.63855635793689802, 0.43387703179650694},
        {-0.63560718924333859, -0.63855635793689802, 0.433877031796507},
        {-0.63560718924333848, -0.63855635793689802, 0.43387703179650694},
        {-0.6356071892433387, -0.63855635793689802, 0.43387703179650677},
        {-0.6356071892433387, -0.63855635793689802, 0.43387703179650661},
        {-0.6356071892433387, -0.63855635793689802, 0.43387703179650677},
        {-0.63560718924333881, -0.63855635793689802, 0.43387703179650666},
        {-0.63560718924333881, -0.63855635793689802, 0.43387703179650661},
        {-0.6356071892433387, -0.63855635793689802, 0.43387703179650666},
        {-0.6356071892433387, -0.63855635793689802, 0.43387703179650666},
        {-0.63560718924333881, -0.63855635793689802, 0.43387703179650661},
        {-0.63560718924333859, -0.63855635793689802, 0.43387703179650677},
        {-0.63560718924333859, -0.63855635793689802, 0.43387703179650694},
        {-0.63560718924333848, -0.63855635793689802, 0.43387703179650683},
        {-0.63560718924333881, -0.63855635793689802, 0.43387703179650666},
        {-0.63560718924333837, -0.63855635793689802, 0.43387703179650711},
        {-0.63560718924333837, -0.63855635793689791, 0.43387703179650738},
        {-0.63560718924333848, -0.63855635793689802, 0.43387703179650716},
        {-0.63560718924333848, -0.63855635793689791, 0.43387703179650711},
        {-0.63560718924333837, -0.63855635793689791, 0.43387703179650716},
        {-0.63560718924333837, -0.63855635793689791, 0.43387703179650716},
        {-0.63560718924333848, -0.63855635793689802, 0.43387703179650711},
        {-0.63560718924333837, -0.63855635793689802, 0.43387703179650727},
        {-0.63560718924333837, -0.63855635793689802, 0.43387703179650733},
        {-0.63560718924333837, -0.63855635793689802, 0.43387703179650727},
        {-0.63560718924333848, -0.63855635793689791, 0.43387703179650711},
        {-0.63560718924333859, -0.63855635793689802, 0.43387703179650672},
        {-0.6356071892433387, -0.63855635793689802, 0.43387703179650672},
        {-0.63560718924333881, -0.63855635793689802, 0.43387703179650666},
        {-0.63560718924333881, -0.63855635793689802, 0.4338770317965065},
        {-0.6356071892433387, -0.63855635793689802, 0.43387703179650661},
        {-0.6356071892433387, -0.63855635793689791, 0.43387703179650661},
        {-0.63560718924333881, -0.63855635793689802, 0.43387703179650666},
        {-0.63560718924333859, -0.63855635793689802, 0.43387703179650672},
        {-0.63560718924333859, -0.63855635793689802, 0.43387703179650672},
        {-0.63560718924333859, -0.63855635793689802, 0.43387703179650688},
        {-0.63560718924333881, -0.63855635793689802, 0.43387703179650666},
        {-0.63560718924333837, -0.63855635793689802, 0.43387703179650716},
        {-0.63560718924333848, -0.63855635793689802, 0.43387703179650722},
        {-0.63560718924333848, -0.63855635793689791, 0.43387703179650705},
        {-0.63560718924333859, -0.63855635793689802, 0.433877031796507},
        {-0.63560718924333848, -0.63855635793689802, 0.43387703179650716},
        {-0.63560718924333848, -0.63855635793689802, 0.43387703179650705},
        {-0.63560718924333848, -0.63855635793689802, 0.43387703179650711},
        {-0.63560718924333837, -0.63855635793689791, 0.43387703179650716},
        {-0.63560718924333837, -0.63855635793689802, 0.43387703179650722},
        {-0.63560718924333837, -0.63855635793689802, 0.43387703179650727},
        {-0.63560718924333848, -0.6385563579368978, 0.43387703179650694},
        {-0.63560718924333859, -0.63855635793689802, 0.43387703179650694},
        {-0.63560718924333848, -0.63855635793689802, 0.43387703179650705},
        {-0.63560718924333859, -0.63855635793689791, 0.43387703179650688},
        {-0.63560718924333859, -0.63855635793689791, 0.43387703179650683},
        {-0.63560718924333859, -0.63855635793689802, 0.43387703179650694},
        {-0.63560718924333859, -0.63855635793689802, 0.433877031796507},
        {-0.63560718924333859, -0.63855635793689791, 0.43387703179650694},
        {-0.63560718924333848, -0.63855635793689802, 0.43387703179650694},
        {-0.63560718924333848, -0.63855635793689802, 0.43387703179650694},
        {-0.63560718924333848, -0.63855635793689802, 0.43387703179650694},
        {-0.63560718924333859, -0.63855635793689791, 0.43387703179650688},
        {-0.63560718924333848, -0.63855635793689802, 0.43387703179650711},
        {-0.63560718924333848, -0.6385563579368978, 0.433877031796507},
        {-0.63560718924333848, -0.6385563579368978, 0.43387703179650694},
        {-0.63560718924333859, -0.63855635793689791, 0.43387703179650694},
        {-0.63560718924333859, -0.63855635793689802, 0.433877031796507},
        {-0.63560718924333859, -0.63855635793689802, 0.433877031796507},
        {-0.63560718924333859, -0.63855635793689791, 0.43387703179650694},
        {-0.63560718924333848, -0.63855635793689802, 0.43387703179650705},
        {-0.63560718924333848, -0.63855635793689802, 0.43387703179650722},
        {-0.63560718924333848, -0.63855635793689802, 0.43387703179650716},
        {-0.63560718924333859, -0.63855635793689791, 0.43387703179650694},
        {-0.63560718924333848, -0.63855635793689802, 0.43387703179650711},
        {-0.63560718924333848, -0.63855635793689802, 0.43387703179650705},
        {-0.63560718924333848, -0.63855635793689791, 0.43387703179650705},
        {-0.63560718924333859, -0.63855635793689791, 0.43387703179650694},
        {-0.63560718924333848, -0.63855635793689802, 0.43387703179650705},
        {-0.63560718924333848, -0.63855635793689802, 0.43387703179650705},
        {-0.63560718924333859, -0.63855635793689791, 0.43387703179650694},
        {-0.63560718924333848, -0.63855635793689802, 0.43387703179650705},
        {-0.63560718924333848, -0.63855635793689802, 0.43387703179650716},
        {-0.63560718924333848, -0.63855635793689802, 0.43387703179650716},
        {-0.63560718924333848, -0.6385563579368978, 0.43387703179650694},
        {-0.63560718924333859, -0.63855635793689802, 0.43387703179650688},
        {-0.63560718924333859, -0.63855635793689791, 0.43387703179650694},
        {-0.6356071892433387, -0.63855635793689802, 0.43387703179650677},
        {-0.63560718924333859, -0.63855635793689791, 0.43387703179650683},
        {-0.63560718924333859, -0.63855635793689802, 0.43387703179650688},
        {-0.63560718924333859, -0.63855635793689802, 0.43387703179650688},
        {-0.63560718924333859, -0.63855635793689791, 0.43387703179650694},
        {-0.63560718924333848, -0.63855635793689802, 0.43387703179650683},
        {-0.63560718924333859, -0.63855635793689802, 0.43387703179650694},
        {-0.63560718924333848, -0.63855635793689802, 0.43387703179650688},
        {-0.6356071892433387, -0.63855635793689802, 0.43387703179650677},
        {-0.63560718924333859, -0.63855635793689802, 0.43387703179650683},
        {-0.63560718924333859, -0.63855635793689791, 0.43387703179650694},
        {-0.6356071892433387, -0.63855635793689802, 0.43387703179650677},
        {-0.63560718924333859, -0.63855635793689791, 0.43387703179650683},
        {-0.6356071892433387, -0.63855635793689802, 0.43387703179650677},
        {-0.63560718924333859, -0.63855635793689802, 0.43387703179650672},
        {-0.63560718924333859, -0.63855635793689791, 0.43387703179650694},
        {-0.63560718924333848, -0.63855635793689802, 0.43387703179650683},
        {-0.63560718924333859, -0.63855635793689802, 0.43387703179650694},
        {-0.63560718924333848, -0.63855635793689802, 0.43387703179650683},
        {-0.6356071892433387, -0.63855635793689802, 0.43387703179650677}
    };

    res2 = cmmcore::SphericalSeparabilityTest(v1, w1);
    print_assert(res2==false, "["+cmmcore::format_vec3vec(v1)+","+ cmmcore::format_vec3vec(w1)+"]");


    std::vector<cmmcore::vec3> v3 = {
        {0.0020853771820782867, -0.90096968455185078, 0.43387703179650711},
        {0.0020853771820781787, -0.90096968455185067, 0.43387703179650688},
        {0.0020853771820781406, -0.90096968455185078, 0.43387703179650688},
        {0.0020853771820782451, -0.90096968455185078, 0.43387703179650711},
        {0.0020853771820782689, -0.90096968455185067, 0.43387703179650705},
        {0.0020853771820782204, -0.90096968455185067, 0.43387703179650694},
        {0.002085377182078125, -0.90096968455185089, 0.43387703179650683},
        {0.0020853771820781648, -0.90096968455185067, 0.43387703179650688},
        {0.0020853771820781648, -0.90096968455185067, 0.43387703179650688},
        {0.0020853771820781232, -0.90096968455185089, 0.43387703179650683},
        {0.0020853771820781371, -0.90096968455185067, 0.43387703179650677},
        {0.0020853771820782867, -0.90096968455185078, 0.43387703179650711},
        {0.0020853771820781787, -0.90096968455185067, 0.43387703179650688},
        {0.0020853771820781267, -0.90096968455185078, 0.43387703179650683},
        {0.0020853771820782451, -0.90096968455185078, 0.43387703179650711},
        {0.0020853771820782689, -0.90096968455185067, 0.43387703179650705},
        {0.0020853771820782342, -0.90096968455185067, 0.433877031796507},
        {0.0020853771820781423, -0.90096968455185078, 0.43387703179650683},
        {0.0020853771820781648, -0.90096968455185067, 0.43387703179650688},
        {0.0020853771820781648, -0.90096968455185067, 0.43387703179650683},
        {0.0020853771820781406, -0.90096968455185078, 0.43387703179650683},
        {0.002085377182078151, -0.90096968455185067, 0.43387703179650683},
        {0.0020853771820782867, -0.90096968455185078, 0.43387703179650711},
        {0.0020853771820781648, -0.90096968455185067, 0.43387703179650683},
        {0.0020853771820780955, -0.90096968455185089, 0.43387703179650677},
        {0.0020853771820782342, -0.90096968455185067, 0.43387703179650694},
        {0.0020853771820782446, -0.90096968455185078, 0.433877031796507},
        {0.0020853771820782065, -0.90096968455185067, 0.43387703179650688},
        {0.0020853771820781111, -0.90096968455185089, 0.43387703179650677},
        {0.0020853771820781648, -0.90096968455185067, 0.43387703179650688},
        {0.002085377182078151, -0.90096968455185067, 0.43387703179650677},
        {0.0020853771820781271, -0.90096968455185089, 0.43387703179650683},
        {0.0020853771820781236, -0.90096968455185089, 0.43387703179650683},
        {0.0020853771820783002, -0.90096968455185056, 0.43387703179650711},
        {0.0020853771820782065, -0.90096968455185067, 0.433877031796507},
        {0.0020853771820781406, -0.90096968455185078, 0.43387703179650688},
        {0.002085377182078259, -0.90096968455185078, 0.43387703179650716},
        {0.0020853771820782824, -0.90096968455185045, 0.43387703179650705},
        {0.0020853771820782451, -0.90096968455185078, 0.43387703179650716},
        {0.0020853771820781562, -0.90096968455185078, 0.43387703179650694},
        {0.0020853771820781926, -0.90096968455185067, 0.433877031796507},
        {0.0020853771820781787, -0.90096968455185067, 0.43387703179650694},
        {0.0020853771820781544, -0.90096968455185078, 0.43387703179650694},
        {0.0020853771820781648, -0.90096968455185067, 0.43387703179650694},
        {0.0020853771820782481, -0.90096968455185067, 0.43387703179650683},
        {0.0020853771820781514, -0.90096968455185089, 0.43387703179650683},
        {0.0020853771820780855, -0.90096968455185089, 0.43387703179650672},
        {0.0020853771820781926, -0.90096968455185067, 0.43387703179650677},
        {0.0020853771820782308, -0.90096968455185078, 0.43387703179650694},
        {0.0020853771820781787, -0.90096968455185067, 0.43387703179650677},
        {0.0020853771820781011, -0.90096968455185089, 0.43387703179650672},
        {0.0020853771820781375, -0.90096968455185089, 0.43387703179650683},
        {0.0020853771820781236, -0.90096968455185089, 0.43387703179650677},
        {0.0020853771820780994, -0.90096968455185089, 0.43387703179650672},
        {0.0020853771820781098, -0.90096968455185089, 0.43387703179650677},
        {0.0020853771820782481, -0.90096968455185067, 0.43387703179650688},
        {0.0020853771820781375, -0.90096968455185089, 0.43387703179650677},
        {0.0020853771820781132, -0.90096968455185089, 0.43387703179650683},
        {0.0020853771820782204, -0.90096968455185067, 0.43387703179650688},
        {0.0020853771820782169, -0.90096968455185078, 0.43387703179650688},
        {0.0020853771820781926, -0.90096968455185067, 0.43387703179650683},
        {0.0020853771820781111, -0.90096968455185089, 0.43387703179650677},
        {0.002085377182078151, -0.90096968455185067, 0.43387703179650677},
        {0.0020853771820781375, -0.90096968455185089, 0.43387703179650683},
        {0.0020853771820781093, -0.90096968455185089, 0.43387703179650677},
        {0.0020853771820781098, -0.90096968455185089, 0.43387703179650672},
        {0.0020853771820782481, -0.90096968455185067, 0.43387703179650688},
        {0.0020853771820781648, -0.90096968455185067, 0.43387703179650683},
        {0.0020853771820781132, -0.90096968455185089, 0.43387703179650683},
        {0.0020853771820782065, -0.90096968455185067, 0.43387703179650683},
        {0.0020853771820782169, -0.90096968455185078, 0.43387703179650688},
        {0.0020853771820781926, -0.90096968455185067, 0.43387703179650683},
        {0.0020853771820781111, -0.90096968455185089, 0.43387703179650677},
        {0.002085377182078151, -0.90096968455185067, 0.43387703179650677},
        {0.0020853771820781375, -0.90096968455185089, 0.43387703179650683},
        {0.0020853771820781271, -0.90096968455185089, 0.43387703179650683},
        {0.0020853771820781371, -0.90096968455185067, 0.43387703179650677},
        {0.0020853771820782481, -0.90096968455185067, 0.43387703179650688},
        {0.0020853771820781484, -0.90096968455185089, 0.43387703179650683},
        {0.0020853771820781132, -0.90096968455185089, 0.43387703179650683},
        {0.0020853771820782204, -0.90096968455185067, 0.43387703179650688},
        {0.0020853771820782308, -0.90096968455185078, 0.43387703179650694},
        {0.0020853771820782065, -0.90096968455185067, 0.43387703179650688},
        {0.002085377182078115, -0.90096968455185089, 0.43387703179650677},
        {0.002085377182078151, -0.90096968455185067, 0.43387703179650677},
        {0.002085377182078151, -0.90096968455185067, 0.43387703179650677},
        {0.0020853771820781271, -0.90096968455185089, 0.43387703179650683},
        {0.0020853771820781206, -0.90096968455185089, 0.43387703179650683},
        {0.002085377182078262, -0.90096968455185067, 0.43387703179650694},
        {0.0020853771820781648, -0.90096968455185067, 0.43387703179650683},
        {0.0020853771820781267, -0.90096968455185078, 0.43387703179650683},
        {0.0020853771820782065, -0.90096968455185067, 0.43387703179650683},
        {0.0020853771820782169, -0.90096968455185078, 0.43387703179650688},
        {0.0020853771820781926, -0.90096968455185067, 0.43387703179650683},
        {0.0020853771820781111, -0.90096968455185089, 0.43387703179650677},
        {0.0020853771820781648, -0.90096968455185067, 0.43387703179650683},
        {0.0020853771820781375, -0.90096968455185089, 0.43387703179650683},
        {0.0020853771820781406, -0.90096968455185078, 0.43387703179650683},
        {0.002085377182078151, -0.90096968455185067, 0.43387703179650683},
        {0.0020853771820782069, -0.90096968455185089, 0.43387703179650677},
        {0.0020853771820781167, -0.90096968455185089, 0.43387703179650666},
        {0.0020853771820780781, -0.90096968455185078, 0.43387703179650661},
        {0.0020853771820781792, -0.90096968455185089, 0.43387703179650677},
        {0.0020853771820781722, -0.90096968455185089, 0.43387703179650672},
        {0.0020853771820781514, -0.90096968455185089, 0.43387703179650672},
        {0.0020853771820780937, -0.90096968455185078, 0.43387703179650661},
        {0.0020853771820781098, -0.90096968455185089, 0.43387703179650672},
        {0.0020853771820781028, -0.90096968455185089, 0.43387703179650666},
        {0.002085377182078092, -0.90096968455185078, 0.43387703179650661},
        {0.002085377182078089, -0.90096968455185089, 0.43387703179650661},
        {0.002085377182078193, -0.90096968455185089, 0.43387703179650672},
        {0.0020853771820781167, -0.90096968455185089, 0.43387703179650666},
        {0.0020853771820780642, -0.90096968455185078, 0.43387703179650655},
        {0.0020853771820781653, -0.90096968455185089, 0.43387703179650672},
        {0.0020853771820781722, -0.90096968455185089, 0.43387703179650672},
        {0.0020853771820781514, -0.90096968455185089, 0.43387703179650672},
        {0.0020853771820780798, -0.90096968455185078, 0.43387703179650655},
        {0.0020853771820781028, -0.90096968455185089, 0.43387703179650666},
        {0.002085377182078089, -0.90096968455185089, 0.43387703179650661},
        {0.0020853771820780781, -0.90096968455185078, 0.43387703179650655},
        {0.002085377182078089, -0.90096968455185089, 0.43387703179650661}
    };

    res2 = cmmcore::SphericalSeparabilityTest(v3, w1);
    print_assert(res2==true, "["+cmmcore::format_vec3vec(v3)+","+ cmmcore::format_vec3vec(w1)+"]");

    res2 = cmmcore::SphericalSeparabilityTest(v3, v1);
    print_assert(res2==true, "["+cmmcore::format_vec3vec(v3)+","+ cmmcore::format_vec3vec(v1)+"]");


    return 0;
}
